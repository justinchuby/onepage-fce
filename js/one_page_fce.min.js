function Course(t){this.year=t.year||"",this.section=t.section||"",this.type=t.type||"",this.courseid=t.courseid||"",this.resp_rate=t.resp_rate||"",this.semester=t.semester||"",this.name=t.name||"",this.enrollment=t.enrollment||"",this.co_taught=t.co_taught||"",this.department=t.department||"",this.responses=t.responses||"",this.instructor=t.instructor||"",this.questions=function(t){return q={},$.each(t.questions||{},function(t,e){e.body.startsWith("Q-")&&(q[e.body]=e.value)}),q}(t),this.getTable=function(){var t=[];t.push('<a target="_blank" href="https://www.cmucoursefind.xyz/courses/' + this.courseid +'" title="' + this.name + '">',this.courseid,"</a>");var e=[t.join(""),this.year,this.semester,this.instructor,normalizeScore(this.questions["Q-10"]),normalizeScore(this.questions["Q-09"]),normalizeScore(this.questions["Q-07"]),normalizeScore(this.questions["Q-02"]),this.questions["Q-01"],this.enrollment,this.resp_rate.toLocaleString("en",{style:"percent"})];return table="<tr><td>"+e.join("</td><td>")+"</td></tr>",table}}function normalizeScore(t){return Math.round(25*(t-1))}function search(t){var e,s,n=t.match(/(\d{2})[-]?(\d{3})/);null!==n?e=n[1]+"-"+n[2]:s=t;var o,r="https://api.cmucoursefind.xyz/fce/v1/";e?o=r.concat("courseid/",e,"/"):s&&(o=r.concat("instructor/",s,"/")),o&&$.getJSON(o,function(t){var e=[],s="<br/>";try{var n=t.fces;0==n.length&&(s="Nothing was found.");for(i in n)hit=n[i],course=new Course(hit),e.push(course.getTable())}catch(t){s="Some thing went wrong. "+t}$("#result-body").remove(),$("#prompt-text").remove(),$("<tbody/>",{id:"result-body",html:e.join("")}).appendTo("#search-result"),$("<p/>",{id:"prompt-text",html:s}).appendTo("#prompt-div"),$("#search-result").removeAttr("data-sortable-initialized"),Sortable.init()})}function handleHashChange(){var t=decodeURIComponent(location.hash.slice(1));$("#search-form :input").val(t),search(t)}function setHash(t){if(t!=decodeURIComponent(location.hash.slice(1))){var e=encodeURIComponent(t);window.location.hash="#"+e}}$(function(){$("#search-form").on("submit",function(t){t.preventDefault();var e=$("#search-form :input").val();setHash(e),search(e)}),handleHashChange(),window.addEventListener("hashchange",handleHashChange)});
